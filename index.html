<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plug & Play Shop - Where Your Dreams Come to Life</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" />
</head>
<body>
<header>
  <button id="menu-btn" aria-label="Toggle menu" aria-expanded="false">&#9776;</button>
  <h1 id="site-title">Plug & Play Shop</h1>
  <nav id="side-nav" aria-label="Primary navigation">
    <a href="index.html" tabindex="0">Shop</a>
    <a href="search.html" tabindex="0">Search</a>
    <a href="support.html" tabindex="0">Support</a>
    <a href="themes.html" tabindex="0">Themes</a>
    <a href="developer.html" tabindex="0">Developer Panel</a>
  </nav>
  <div class="header-right">
    <button id="login-btn" aria-haspopup="dialog" aria-controls="login-modal">Login</button>
    <button id="cart-icon" aria-label="View cart" aria-haspopup="true" aria-controls="cart-dropdown">
      ðŸ›’ <span id="cart-count" aria-live="polite" aria-atomic="true">0</span>
    </button>
  </div>
</header>

<main>
  <section id="welcome-section" tabindex="0">
    <h2>Welcome to Plug & Play Shop where your dreams come to life</h2>
  </section>

  <section id="products" aria-label="Product listings" tabindex="0">
    <!-- Products will be dynamically injected here -->
  </section>
</main>

<!-- Login Modal -->
<div id="login-modal" role="dialog" aria-modal="true" aria-labelledby="login-title" hidden>
  <div class="modal-content">
    <h3 id="login-title">Developer Panel Login</h3>
    <label for="pin-input">Enter PIN:</label>
    <input id="pin-input" type="password" maxlength="4" aria-describedby="login-message" />
    <div id="login-message" role="alert" aria-live="assertive"></div>
    <div class="modal-buttons">
      <button id="login-submit">Submit</button>
      <button id="login-cancel">Cancel</button>
    </div>
  </div>
</div>

<script src="js/store.js" defer></script>
<script src="js/themes.js" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Hamburger menu toggle
    const menuBtn = document.getElementById('menu-btn');
    const sideNav = document.getElementById('side-nav');
    menuBtn.addEventListener('click', () => {
      const expanded = menuBtn.getAttribute('aria-expanded') === 'true';
      menuBtn.setAttribute('aria-expanded', String(!expanded));
      sideNav.classList.toggle('open');
    });

    // Render products from storage
    renderProducts();

    // Cart icon setup
    setupCartIcon();

    // Login modal elements
    const loginBtn = document.getElementById('login-btn');
    const loginModal = document.getElementById('login-modal');
    const pinInput = document.getElementById('pin-input');
    const loginSubmit = document.getElementById('login-submit');
    const loginCancel = document.getElementById('login-cancel');
    const loginMessage = document.getElementById('login-message');

    const DEVELOPER_PIN = '7391';

    loginBtn.addEventListener('click', () => {
      loginModal.hidden = false;
      pinInput.value = '';
      loginMessage.textContent = '';
      pinInput.focus();
    });

    loginCancel.addEventListener('click', () => {
      loginModal.hidden = true;
    });

    loginSubmit.addEventListener('click', tryLogin);
    pinInput.addEventListener('keypress', e => {
      if(e.key === 'Enter') tryLogin();
    });

    function tryLogin() {
      if(pinInput.value === DEVELOPER_PIN) {
        loginMessage.style.color = 'green';
        loginMessage.textContent = 'PIN correct! Redirecting...';
        localStorage.setItem('devUnlocked', 'true');
        setTimeout(() => {
          loginModal.hidden = true;
          window.location.href = 'developer.html';
        }, 700);
      } else {
        loginMessage.style.color = 'red';
        loginMessage.textContent = 'Incorrect PIN. Please try again.';
        pinInput.value = '';
        pinInput.focus();
      }
    }
  });
</script>
</body>
</html>
